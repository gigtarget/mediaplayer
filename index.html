<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>iOS26 Glass Music Player – Manual Crop Export</title>
<link href="https://cdn.jsdelivr.net/npm/cropperjs@1.6.2/dist/cropper.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/cropperjs@1.6.2/dist/cropper.min.js"></script>
<style>
:root{
  --bg1:#0b0f1a;--bg2:#151a29;
  --glass:rgba(255,255,255,.08);--glass-strong:rgba(255,255,255,.14);
  --stroke:rgba(255,255,255,.22);--text:#edf2ff;--muted:#a6b0c2;
  --accent:#6aa8ff;--accent-2:#b387ff;
  --shadow:0 20px 50px rgba(0,0,0,.45);
}
.light{
  --bg1:#f0f4ff;--bg2:#e8ecfb;
  --glass:rgba(255,255,255,.6);--glass-strong:rgba(255,255,255,.85);
  --stroke:rgba(10,20,40,.12);--text:#0b1020;--muted:#46506a;
  --shadow:0 12px 40px rgba(30,40,80,.18);
}
*{box-sizing:border-box;}
html,body{height:100%;margin:0;font-family:-apple-system,system-ui,"SF Pro Text","Inter",Segoe UI,Roboto,Helvetica,Arial;}
body{display:grid;grid-template-rows:auto 1fr;gap:14px;padding:16px;
background:linear-gradient(135deg,var(--bg1),var(--bg2));color:var(--text);transition:background .4s ease;}
.panel{display:flex;flex-wrap:wrap;gap:10px;align-items:end;padding:10px 12px;
border:1px solid var(--stroke);
background:linear-gradient(180deg,rgba(255,255,255,.14),rgba(255,255,255,.08));
border-radius:16px;}
.panel label{font-size:12px;display:flex;flex-direction:column;gap:6px;color:var(--muted);}
.panel input[type=text],.panel input[type=file]{padding:10px 12px;min-width:200px;border-radius:10px;
border:1px solid var(--stroke);background:rgba(255,255,255,.06);color:var(--text);}
.btn{padding:10px 14px;border-radius:12px;border:1px solid var(--stroke);
background:linear-gradient(180deg,rgba(255,255,255,.18),rgba(255,255,255,.1));
color:var(--text);cursor:pointer;transition:.2s;}
.btn:hover{transform:translateY(-1px);}
.btn.primary{background:linear-gradient(180deg,var(--accent),var(--accent-2));border:none;color:#fff;}
.info{font-size:12px;color:var(--muted);margin-left:auto;}
#stage{position:relative;width:min(92vw,1280px);aspect-ratio:16/9;border-radius:34px;overflow:hidden;margin:0 auto;transition:all .5s;}
#stage.tall{aspect-ratio:9/16;width:min(90vw,480px);}
.bg-orbs{position:absolute;inset:0;pointer-events:none;}
.bg-orbs:before,.bg-orbs:after{content:"";position:absolute;filter:blur(80px);opacity:.55;mix-blend-mode:screen;border-radius:50%;}
.bg-orbs:before{width:42%;height:42%;left:-8%;top:-10%;background:radial-gradient(circle at 30% 30%,#6aa8ff,transparent 60%);}
.bg-orbs:after{width:46%;height:46%;right:-6%;bottom:-12%;background:radial-gradient(circle at 70% 70%,#b387ff,transparent 60%);}
.glass-wrap{position:absolute;inset:0;padding:28px;display:grid;}
.player{margin:auto;display:grid;grid-template-columns:340px 1fr;gap:28px;align-items:center;
background:linear-gradient(180deg,var(--glass-strong),var(--glass));
backdrop-filter:blur(22px)saturate(1.25);-webkit-backdrop-filter:blur(22px)saturate(1.25);
border:1px solid var(--stroke);border-radius:28px;box-shadow:var(--shadow);
padding:24px;width:min(100%,1100px);transition:all .4s;}
#stage.tall .player{grid-template-columns:1fr;grid-template-rows:auto auto;width:90%;padding:18px;}
.cover{position:relative;aspect-ratio:1/1;border-radius:24px;overflow:hidden;
background:linear-gradient(135deg,#0d121f,#141b2d);border:1px solid var(--stroke);
display:grid;place-items:center;}
.cover img{width:100%;height:100%;object-fit:cover;object-position:center;}
.meta h1{margin:0 0 6px;font-size:28px;text-align:center;}
.meta h2{margin:0 0 18px;font-size:16px;font-weight:500;color:var(--muted);text-align:center;}
#stage.tall .meta h1{font-size:24px;}
#stage.tall .meta h2{font-size:14px;}

/* FIXED BADGE */
.badge{
  font-size:18px;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:linear-gradient(180deg,rgba(255,255,255,.12),rgba(255,255,255,.06));
  text-transform:uppercase;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-right:8px;
  line-height:1;
}

.timeline{width:100%;height:6px;background:rgba(255,255,255,.1);
border-radius:999px;overflow:hidden;margin-top:20px;}
.timeline-fill{width:60%;height:100%;background:var(--accent);transition:width 1s linear;}
.controls{margin-top:22px;display:flex;justify-content:center;align-items:center;gap:20px;}
.controls button{background:linear-gradient(180deg,rgba(255,255,255,.18),rgba(255,255,255,.08));
border:1px solid var(--stroke);border-radius:50%;width:48px;height:48px;display:grid;place-items:center;
cursor:pointer;transition:all .2s ease;}
.controls button:hover{transform:scale(1.1);}
.controls svg{width:22px;height:22px;fill:var(--text);}
.credits{position:absolute;bottom:18px;left:18px;font-size:11px;color:var(--muted);opacity:.85;}

#cropModal{
  position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;
  justify-content:center;align-items:center;z-index:100;
}
#cropBox{
  background:#111;padding:20px;border-radius:16px;box-shadow:0 0 20px rgba(0,0,0,.6);
  display:flex;flex-direction:column;align-items:center;gap:10px;
}
#cropImage{max-width:80vw;max-height:70vh;}
</style>
</head>
<body>

<div class="panel">
  <label>Song Title <input id="inTitle" type="text" value=" | "/></label>
  <label>Artist Name <input id="inArtist" type="text" value=" Woven by Jatin Dhiman"/></label>
  <label>Cover Image <input id="inCover" type="file" accept="image/*"/></label>
  <button class="btn" onclick="toggleTheme()">Light/Dark</button>
  <button class="btn" onclick="toggleAspect()">Aspect: <span id="aspectLabel">16:9</span></button>
  <div class="info"><button class="btn primary" onclick="downloadPNG()">Download PNG</button></div>
</div>

<div id="stage">
  <div class="bg-orbs"></div>
  <div class="glass-wrap">
    <div class="player">
      <div class="cover" id="cover"></div>
      <div class="right">
        <div class="meta">
          <h1 id="title" contenteditable>SAHIBA | Afro Chill Hindi Cover</h1>
          <h2 id="artist" contenteditable>House of Tyche • Woven by Jatin Dhiman</h2>

          <div class="badge">HI-RES</div>
          <div class="badge">STEREO</div>
          <div class="badge">24-BIT</div>

          <div class="timeline"><div class="timeline-fill" id="timeline"></div></div>

          <div class="controls">
            <button onclick="prevTrack()"><svg viewBox="0 0 24 24"><path d="M6 4v16l8.5-8L6 4zm9 0v16h3V4h-3z"/></svg></button>
            <button id="ppBtn" onclick="togglePlayPause()">
              <svg id="ppIcon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
            <button onclick="nextTrack()"><svg viewBox="0 0 24 24"><path d="M18 4v16l-8.5-8L18 4zm-11 0v16h3V4H7z"/></svg></button>
            <button onclick="toggleRepeat()"><svg viewBox="0 0 24 24"><path d="M17 17H7v-3l-4 4 4 4v-3h10c1.1 0 2-.9 2-2v-4h-2v4zM7 7h10v3l4-4-4-4v3H7c-1.1 0-2 .9-2 2v4h2V7z"/></svg></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="credits">Like, Share & Subscribe • House of Tyche • Woven by Jatin Dhiman</div>
</div>

<div id="cropModal">
  <div id="cropBox">
    <img id="cropImage" src="">
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button class="btn primary" id="applyCrop">Apply</button>
      <button class="btn" id="cancelCrop">Cancel</button>
    </div>
  </div>
</div>

<script>
const stage=document.querySelector('#stage'),
cover=document.querySelector('#cover'),
titleEl=document.querySelector('#title'),
artistEl=document.querySelector('#artist'),
ppIcon=document.querySelector('#ppIcon'),
timeline=document.querySelector('#timeline'),
inCover=document.querySelector('#inCover'),
aspectLabel=document.querySelector('#aspectLabel');

let isPlaying=false,repeat=false,cropper=null,uploadedImageURL='',isTall=false;

function togglePlayPause(){
  isPlaying=!isPlaying;
  ppIcon.innerHTML=isPlaying?'<path d="M6 5h4v14H6zm8 0h4v14h-4z"/>':'<path d="M8 5v14l11-7z"/>';
  timeline.style.width=isPlaying?'100%':'60%';
}
function prevTrack(){alert("Previous Track (visual only)");}
function nextTrack(){alert("Next Track (visual only)");}
function toggleRepeat(){repeat=!repeat;alert("Repeat "+(repeat?"On":"Off"));}

function toggleTheme(){document.body.classList.toggle('light');}

function toggleAspect(){
  isTall=!isTall;
  if(isTall){
    stage.classList.add('tall');
    aspectLabel.textContent='9:16';
  }else{
    stage.classList.remove('tall');
    aspectLabel.textContent='16:9';
  }
}

document.querySelector('#inTitle').oninput=e=>titleEl.textContent=e.target.value;
document.querySelector('#inArtist').oninput=e=>artistEl.textContent=e.target.value;

inCover.addEventListener('change',e=>{
  const f=e.target.files?.[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=ev=>{
    uploadedImageURL=ev.target.result;
    openCropper(uploadedImageURL);
  };
  r.readAsDataURL(f);
});

function openCropper(imgSrc){
  const modal=document.getElementById('cropModal');
  const cropImg=document.getElementById('cropImage');
  cropImg.src=imgSrc;
  modal.style.display='flex';
  cropper=new Cropper(cropImg,{
    aspectRatio:1,
    viewMode:1,
    dragMode:'move',
    background:false,
    autoCropArea:1,
  });
  document.getElementById('applyCrop').onclick=()=>{
    const canvas=cropper.getCroppedCanvas({width:600,height:600});
    const croppedData=canvas.toDataURL('image/png');
    cover.innerHTML=`<img src="${croppedData}" alt="cover"/>`;
    cropper.destroy();
    modal.style.display='none';
  };
  document.getElementById('cancelCrop').onclick=()=>{
    cropper.destroy();
    modal.style.display='none';
  };
}

async function downloadPNG(){
  const canvas=await html2canvas(stage,{backgroundColor:null,scale:2,useCORS:true});
  canvas.toBlob(blob=>{
    const a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download=`${titleEl.textContent.replace(/\s+/g,'_')}.png`;
    a.click();
    setTimeout(()=>URL.revokeObjectURL(a.href),2000);
  });
}
</script>

</body>
</html>
